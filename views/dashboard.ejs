<style>
    /* Estilos espec√≠ficos do Dashboard */
    .dash-header { display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 1rem; margin-bottom: 2rem; }
    .welcome-text h1 { margin: 0; color: #2563eb; font-size: 1.75rem; }
    .welcome-text p { margin: 0; color: #2563eb; font-size: 1rem; }
    .date-badge { font-size: 0.9rem; font-weight: 600; color: #4b5563; background: white; padding: 0.5rem 1rem; border-radius: 99px; box-shadow: 0 1px 3px rgba(0,0,0,0.05); border: 1px solid #e5e7eb; display: flex; align-items: center; gap: 0.5rem; }
    .stats-grid { display: grid; grid-template-columns: 1fr; gap: 1.5rem; margin-bottom: 2.5rem; }
    @media (min-width: 640px) { .stats-grid { grid-template-columns: repeat(2, 1fr); } }
    @media (min-width: 1024px) { .stats-grid { grid-template-columns: repeat(4, 1fr); } }
    .stat-card { padding: 1.5rem; border-radius: 1rem; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1); text-decoration: none; display: flex; flex-direction: column; justify-content: space-between; color: white !important; transition: transform 0.2s, box-shadow 0.2s; position: relative; overflow: hidden; min-height: 140px; }
    .stat-card:hover { transform: translateY(-5px); box-shadow: 0 10px 15px -3px rgba(0,0,0,0.2); }
    .stat-label { font-size: 0.9rem; font-weight: 500; opacity: 0.9; z-index: 2; margin: 0; }
    .stat-value { font-size: 2.5rem; font-weight: 800; margin: 0.5rem 0 0 0; z-index: 2; line-height: 1; color: #fff;}
    .stat-icon-bg { position: absolute; right: -15px; bottom: -15px; opacity: 0.15; transform: rotate(-15deg); z-index: 1; font-size: 5rem; }
    .bg-new { background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%); }
    .bg-progress { background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%); }
    .bg-waiting { background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%); }
    .bg-closed { background: linear-gradient(135deg, #4b5563 0%, #1f2937 100%); }
    .quick-search { margin-bottom: 2.5rem; }
    .search-title { margin-bottom: 0.75rem; color: #374151; font-size: 1rem; font-weight: 600; }
    .search-form { display: flex; gap: 0.75rem; flex-wrap: wrap; }
    .search-input { flex: 1; min-width: 250px; padding: 0.875rem; border: 1px solid #d1d5db; border-radius: 0.5rem; font-size: 1rem; transition: border 0.2s; }
    .search-input:focus { border-color: #2563eb; outline: none; }
    .search-btn { background: #111827; color: white; border: none; padding: 0 1.5rem; border-radius: 0.5rem; cursor: pointer; font-weight: 600; transition: background 0.2s; }
    .lists-container { display: grid; gap: 2rem; grid-template-columns: 1fr; }
    @media (min-width: 1024px) { .lists-container { grid-template-columns: 1fr 1fr; } }
    .ticket-card { background: white; padding: 1rem; border-radius: 0.75rem; box-shadow: 0 1px 2px rgba(0,0,0,0.05); border: 1px solid #e5e7eb; border-left-width: 5px; margin-bottom: 1rem; cursor: pointer; transition: all 0.2s; }
    .ticket-card:hover { transform: translateY(-2px); box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1); }
    .ticket-card.new { border-left-color: #2563eb; }
    .ticket-card.progress { border-left-color: #f59e0b; }
    .badge { font-size: 0.65rem; padding: 2px 8px; border-radius: 99px; font-weight: 700; text-transform: uppercase; }
    .badge-new { background: #eff6ff; color: #1e40af; border: 1px solid #bfdbfe; }
    .badge-prog { background: #fffbeb; color: #b45309; border: 1px solid #fde68a; }
</style>

<div class="container" style="padding: 1.5rem;">
    <div class="dash-header">
        <div class="welcome-text">
            <h1>Tech Dashboard</h1>
            <p>Welcome back, <strong><%= user.NOME %></strong>!</p>
        </div>
        <div class="date-badge">
            <i class="far fa-calendar-alt"></i> <%= currentDate %>
        </div>
    </div>

    <div class="stats-grid">
        <a href="/os?status=23" class="stat-card bg-new">
            <div><p class="stat-label">New Tickets</p><h2 class="stat-value"><%= stats.new %></h2></div>
            <div class="stat-icon-bg"><i class="fas fa-inbox"></i></div>
        </a>
        <a href="/os?status=21" class="stat-card bg-progress">
            <div><p class="stat-label">In Progress</p><h2 class="stat-value"><%= stats.pending %></h2></div>
            <div class="stat-icon-bg"><i class="fas fa-tools"></i></div>
        </a>
        <a href="/os?status=22" class="stat-card bg-waiting">
            <div><p class="stat-label">Ready for Pickup</p><h2 class="stat-value"><%= stats.awaitingClosure %></h2></div>
            <div class="stat-icon-bg"><i class="fas fa-check-circle"></i></div>
        </a>
        <a href="/os?status=9" class="stat-card bg-closed">
            <div><p class="stat-label">Closed Today</p><h2 class="stat-value"><%= stats.closed %></h2></div>
            <div class="stat-icon-bg"><i class="fas fa-archive"></i></div>
        </a>
    </div>

    <div class="quick-search">
        <h3 class="search-title">Quick Search</h3>
        <form action="/os" method="GET" class="search-form">
            <input type="text" name="search" class="search-input" placeholder="Search by Client, OS ID, or Serial...">
            <button type="submit" class="search-btn">Search</button>
        </form>
    </div>

    <div class="lists-container">
        <div class="list-column">
            <h3 style="color: #2563eb; margin-bottom: 1rem;">Recent New Tickets</h3>
            <% if (newTickets.length === 0) { %>
                <div style="color: #9ca3af;">No new tickets today.</div>
            <% } else { %>
                <% newTickets.forEach(t => { %>
                    <div class="ticket-card new" onclick="window.location.href='/os/edit/<%= t.raw_id %>'">
                        <div style="display:flex; justify-content:space-between;">
                            <span style="font-weight:bold; color:#9ca3af;">#<%= t.id %></span>
                            <span class="badge badge-new">NEW</span>
                        </div>
                        <div style="font-weight:bold; margin: 0.5rem 0;"><%= t.equip_title %></div>
                        <div style="font-size:0.85rem; color:#6b7280;"><%= t.client_name %></div>
                    </div>
                <% }) %>
            <% } %>
        </div>

        <div class="list-column">
            <h3 style="color: #d97706; margin-bottom: 1rem;">Active Work</h3>
            <% if (inProgressTickets.length === 0) { %>
                <div style="color: #9ca3af;">No active work in progress.</div>
            <% } else { %>
                <% inProgressTickets.forEach(t => { %>
                    <div class="ticket-card progress" onclick="window.location.href='/os/edit/<%= t.raw_id %>'">
                        <div style="display:flex; justify-content:space-between;">
                            <span style="font-weight:bold; color:#9ca3af;">#<%= t.id %></span>
                            <span class="badge badge-prog">WORKING</span>
                        </div>
                        <div style="font-weight:bold; margin: 0.5rem 0;"><%= t.equip_title %></div>
                        <div style="font-size:0.85rem; color:#6b7280;"><%= t.client_name %></div>
                    </div>
                <% }) %>
            <% } %>
        </div>
    </div>
</div>